<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>housingmagician_finalcode.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id='container'>
  <div id="background"></div>
  <div class='section'>
    <div class='docs'><h1>housingmagician_finalcode.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p>HousingMagician_FinalCode.ipynb</p>
<p>Automatically generated by Colaboratory.</p>
<p>Original file is located at
    https://colab.research.google.com/drive/1FAbh4xVVrN-oqH9RcGwJEpruww_u-V7H</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>For visualisation</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objs</span> <span class="k">as</span> <span class="nn">go</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>For data preprocessing
!pip install geopy</p>
<h1>Data Pre-processing Stage-1: <strong>Importing and Cleaning data</strong></h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">geopy</span>
<span class="kn">from</span> <span class="nn">geopy.geocoders</span> <span class="kn">import</span> <span class="n">Nominatim</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>

<span class="kn">import</span> <span class="nn">folium</span>
<span class="kn">from</span> <span class="nn">folium</span> <span class="kn">import</span> <span class="n">Choropleth</span><span class="p">,</span> <span class="n">Circle</span><span class="p">,</span> <span class="n">Marker</span>
<span class="kn">from</span> <span class="nn">folium.plugins</span> <span class="kn">import</span> <span class="n">HeatMap</span><span class="p">,</span> <span class="n">MarkerCluster</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>Reading the files</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">df_banglore</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Bangalore.csv&#39;</span><span class="p">)</span>
<span class="n">df_chennai</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Chennai.csv&#39;</span><span class="p">)</span>
<span class="n">df_delhi</span>    <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Delhi.csv&#39;</span><span class="p">)</span>
<span class="n">df_hyderabad</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Hyderabad.csv&#39;</span><span class="p">)</span>
<span class="n">df_kolkata</span>  <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Kolkata.csv&#39;</span><span class="p">)</span>
<span class="n">df_mumbai</span>   <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;Mumbai.csv&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>Combining the files into one </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">df_banglore</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;Banglore&#39;</span>
<span class="n">df_chennai</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;Chennai&#39;</span>
<span class="n">df_delhi</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;Delhi&#39;</span>
<span class="n">df_hyderabad</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;Hyderabad&#39;</span>
<span class="n">df_kolkata</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;Kolkata&#39;</span>
<span class="n">df_mumbai</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;Mumbai&#39;</span>

<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_banglore</span><span class="p">,</span> <span class="n">df_chennai</span><span class="p">,</span> <span class="n">df_delhi</span><span class="p">,</span> <span class="n">df_hyderabad</span><span class="p">,</span> <span class="n">df_kolkata</span><span class="p">,</span> <span class="n">df_mumbai</span><span class="p">])</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>The digit &lsquo;9&rsquo; seems to be used to indicate the absence of information about certain predictor variables. 
We&rsquo;ll clean the dataframe by dropping these values.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>When no. of training samples corresponding to a particular location are very less, 
then it is hard to predict price accurately for test data in that specific location. 
Hence, to improve accuracy, we are removing data points whole location appears very rare in the dataset (&lt;=10). </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">loc_stats</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Location&#39;</span><span class="p">)[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">loc_stats_less_than_10</span><span class="o">=</span><span class="n">loc_stats</span><span class="p">[</span><span class="n">loc_stats</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">Location</span><span class="o">=</span><span class="n">df</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">loc_stats_less_than_10</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>Converting rupees to lakhs
RUN THIS ONLY ONCE OTHERWISE PRICE WILL BE REDUCED BY A FACTOR OF 10^5 MULTIPLE TIMES!</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">/</span><span class="mi">10</span><span class="o">**</span><span class="mi">5</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>Adding the latitute and longitute for the places</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">location</span><span class="o">=</span><span class="n">Nominatim</span><span class="p">(</span><span class="n">user_agent</span><span class="o">=</span><span class="s1">&#39;user_me_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">randint</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span><span class="mi">99999</span><span class="p">)))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">get_location_code</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>                                                           <span class="c1">## Error handling using try and catch block!</span>
        <span class="n">cordinates</span><span class="o">=</span><span class="n">location</span><span class="o">.</span><span class="n">geocode</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">country_codes</span><span class="o">=</span><span class="s1">&#39;in&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cordinates</span><span class="o">.</span><span class="n">latitude</span><span class="p">,</span> <span class="n">cordinates</span><span class="o">.</span><span class="n">longitude</span>  
    <span class="k">except</span><span class="p">:</span>
        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.030</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;Not found&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>Finding lat/long for unique loactions only for speeding up execution</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">unique_location</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">location_to_code</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">place</span> <span class="ow">in</span> <span class="n">unique_location</span><span class="p">:</span>
    <span class="n">location_to_code</span><span class="p">[</span><span class="n">place</span><span class="p">]</span><span class="o">=</span><span class="n">get_location_code</span><span class="p">(</span><span class="n">place</span><span class="p">)</span> <span class="c1"># This took 6 mins for me! Save this cleaned csv!</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>Creating two new columns having latitude and longitude</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]</span><span class="o">=</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">location_to_code</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>Removing the &lsquo;Not found&rsquo; records</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;Not found&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">]</span><span class="o">!=</span><span class="s1">&#39;N&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>Saving the cleaned data file as it takes plenty of time build.</p>
<h1>Data Pre-processing Stage-2: <strong>Feature Selection</strong></h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;HM-All_Cities_Cleaned_1.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">file_path</span><span class="o">=</span><span class="s1">&#39;HM-All_Cities_Cleaned_1.csv&#39;</span>
<span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>Using a lot of predictors (~40 here!) often leads to model inefficiency and inaccuracy. We&rsquo;ll only select those few features that are highly relevant for our prediction of housing price. Moreover, if two separate feature haves high correlation, it implies both have an almost linear relationship with each other. Thus, we can drop one of them!</p>
<p><strong>Statistical way of selecting features:</strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">features1</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>  <span class="c1">## Correlation between predictor variables and output variable</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">features1</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span> 
<span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span> 

<span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Pearson Correlation Matrix&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">features1</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span><span class="n">linewidths</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span><span class="n">square</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;BuGn&quot;</span><span class="p">,</span> <span class="c1">#&quot;BuGn_r&quot; to reverse </span>
            <span class="n">linecolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;size&quot;</span><span class="p">:</span><span class="mf">6.5</span><span class="p">},</span><span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">,</span><span class="n">cbar_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">.9</span><span class="p">});</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>We&rsquo;ll drop all features having correlation with Price &lt; 0.15 and we&rsquo;ll drop one feature amongst two if their correlation &gt; 0.7. Hence, we selected the following features - Location, Area, Number of bedrooms, Swimming Pool, Power backup, GasConnection, AC, Children&rsquo;s Play Area</p>
<p><strong>Intuitively selecting the features:</strong></p>
<p>Keeping the correlations between predictor and output variables in mind, we removed some features and included only those that seem important from a buyer/seller&rsquo;s point of view. Thre feature set we decided here is - &lsquo;Area&rsquo;,&rsquo;Location&rsquo;,&rsquo;City&rsquo;,&rsquo;No. of Bedrooms&rsquo;,&rsquo;Gymnasium&rsquo;,&rsquo;CarParking&rsquo;,&rsquo;Hospital&rsquo;</p>
<p><strong>FINAL FEATURE SET:</strong></p>
<p>We ran our model on the whole feature set, and the above two feature sets and recorded the accuracies. We got the highest accuracy for the feature set - <strong>&lsquo;Area&rsquo; , &lsquo;Location&rsquo; , &lsquo;City&rsquo; , &lsquo;No. of Bedrooms&rsquo; , &lsquo;Gymnasium&rsquo; , &lsquo;CarParking&rsquo; , &lsquo;Hospital&rsquo;</strong> . The other feature sets did not give high accuracy even though the correlation values were high was due to the presence of outliers. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p>df_1 = df <a href="'Price','Area','Location','City','No.html">&lsquo;Price&rsquo;,&rsquo;Area&rsquo;,&rsquo;Location&rsquo;,&rsquo;City&rsquo;,&rsquo;No. of Bedrooms&rsquo;,&rsquo;SwimmingPool&rsquo;,&rsquo;PowerBackup&rsquo;,&rsquo;Gasconnection&rsquo;,&rsquo;AC&rsquo;,&rdquo;Children&rsquo;splayarea&rdquo;</a>
df_1 = df.copy()</p>
<h1>Data Pre-processing Stage-3: <strong>Exploratory Data Analysis</strong></h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">df_1</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span><span class="s1">&#39;Area&#39;</span><span class="p">,</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span><span class="s1">&#39;City&#39;</span><span class="p">,</span><span class="s1">&#39;No. of Bedrooms&#39;</span><span class="p">,</span><span class="s1">&#39;Gymnasium&#39;</span><span class="p">,</span><span class="s1">&#39;CarParking&#39;</span><span class="p">,</span><span class="s1">&#39;Hospital&#39;</span><span class="p">,</span><span class="s1">&#39;Latitude&#39;</span><span class="p">,</span><span class="s1">&#39;Longitude&#39;</span><span class="p">]]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>We&rsquo;ll perform some inital data plotting to visualise any potential outliers and possible patterns</p>
<p><strong>VARIATION OF HOUSE PRICES:</strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">plot_city_variation</span><span class="p">(</span><span class="n">col_name</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">df</span><span class="p">):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;darkgrid&quot;</span><span class="p">)</span> <span class="c1"># Background grid style</span>
    <span class="n">ax</span><span class="o">=</span><span class="n">sns</span><span class="o">.</span><span class="n">catplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;City&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">col_name</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">jitter</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>For aesthetic purpose
Some houses in Mumbai seem to have prices greater than INR 35 crore! We&rsquo;ll remove these <strong>luxurious outlier points (&gt; INR 1 crore)</strong> before training our models.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="n">ax</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabels</span><span class="p">(</span><span class="s1">&#39;Cities&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabels</span><span class="p">(</span><span class="n">col_name</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">);</span>

<span class="n">plot_city_variation</span><span class="p">(</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span> <span class="s1">&#39;House price variation in various cities&#39;</span><span class="p">,</span><span class="n">df_1</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p><strong>OUTLIER REMOVAL:</strong></p>
<ol>
<li>We&rsquo;ll first create a temporary column of per square feet rate in our dataframe and drop any unrealistic values that are beyond μ-3σ</li>
</ol>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">df1</span> <span class="o">=</span> <span class="n">df_1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df1</span><span class="p">[</span><span class="s1">&#39;price_per_sqft&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">100000</span><span class="o">/</span><span class="n">df1</span><span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">]</span>
<span class="n">df1</span><span class="o">.</span><span class="n">price_per_sqft</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p><strong>Note:</strong> About 374 data points (4 %) got dropped due to removing over luxurious or unnaturally low price per sqft houses!</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">Remove_PPS_Outliers</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="n">df_out</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">subdf</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Location&#39;</span><span class="p">):</span>
        <span class="n">m</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subdf</span><span class="o">.</span><span class="n">price_per_sqft</span><span class="p">)</span>
        <span class="n">st</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">subdf</span><span class="o">.</span><span class="n">price_per_sqft</span><span class="p">)</span>
        <span class="n">reduced_df</span><span class="o">=</span><span class="n">subdf</span><span class="p">[(</span><span class="n">subdf</span><span class="o">.</span><span class="n">price_per_sqft</span><span class="o">&gt;</span><span class="p">(</span><span class="n">m</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">st</span><span class="p">))</span><span class="o">&amp;</span><span class="p">(</span><span class="n">subdf</span><span class="o">.</span><span class="n">price_per_sqft</span><span class="o">&lt;=</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">st</span><span class="p">))]</span>
        <span class="n">df_out</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_out</span><span class="p">,</span><span class="n">reduced_df</span><span class="p">],</span><span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df_out</span>

<span class="n">df2</span><span class="o">=</span><span class="n">Remove_PPS_Outliers</span><span class="p">(</span><span class="n">df1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">df2</span><span class="p">[(</span><span class="n">df2</span><span class="o">.</span><span class="n">Price</span><span class="o">&lt;=</span><span class="p">(</span><span class="mf">1000.0</span><span class="p">))]</span> <span class="c1"># Prices less than 1 crore are considered.  </span>
<span class="n">df2</span> <span class="c1"># plot_city_variation(&#39;Price&#39;, &#39;House price variation in various cities&#39;,df2)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>drop the price_per_sqft column that was created temporarily</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">df3</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;price_per_sqft&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>When no. of training samples corresponding to a particular location are very less, 
then it is hard to predict price accurately for test data in that specific location. 
Hence, to improve accuracy, we are removing data points whole location appears very rare in the dataset (&lt;=10). 
Since <strong>&lsquo;Location&rsquo;</strong> is a categorical variable, we&rsquo;ll have to convert all location values as a binary 0/1 feature before using regression or classification models</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">loc_stats</span><span class="o">=</span><span class="n">df3</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Location&#39;</span><span class="p">)[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">agg</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">loc_stats_less_than_10</span><span class="o">=</span><span class="n">loc_stats</span><span class="p">[</span><span class="n">loc_stats</span><span class="o">&lt;=</span><span class="mi">10</span><span class="p">]</span>
<span class="n">df3</span><span class="o">.</span><span class="n">Location</span><span class="o">=</span><span class="n">df3</span><span class="o">.</span><span class="n">Location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="s1">&#39;other&#39;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">loc_stats_less_than_10</span> <span class="k">else</span> <span class="n">x</span><span class="p">)</span>
<span class="n">df3</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;other&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df3</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">df3</span><span class="o">=</span><span class="n">df3</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">Area</span><span class="o">/</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;No. of Bedrooms&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">300</span><span class="p">)]</span>
<span class="n">df3</span><span class="o">=</span><span class="n">df3</span><span class="p">[</span><span class="o">~</span><span class="p">(</span><span class="n">df3</span><span class="o">.</span><span class="n">Area</span><span class="o">/</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;No. of Bedrooms&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">900</span><span class="p">)]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>We&rsquo;re now in principle ready for using ANY Machine Learning model on our <strong>dataframe df7</strong>! -&gt; by selecting appropriate features</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">df4</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">dummies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">df4</span><span class="o">.</span><span class="n">Location</span><span class="p">)</span>

<span class="n">df5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df4</span><span class="p">,</span><span class="n">dummies</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">df6</span><span class="o">=</span><span class="n">df5</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Location&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">df6</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;HM-All_Cities_Cleaned_Final.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">df7</span> <span class="o">=</span> <span class="n">df6</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;City&#39;</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
<span class="n">df7</span><span class="o">.</span><span class="n">info</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p><strong>&lsquo;Price&rsquo;</strong> is our response with all other columns being the predictors</p>
<h1><strong>Regression Models</strong></h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <p>We&rsquo;ll fill this evaluation df with results/scores dumped by different models and compare them at the end!</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">evaluation</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Model Name&#39;</span><span class="p">:</span> <span class="p">[],</span>
                           <span class="s1">&#39;Details&#39;</span><span class="p">:[],</span>
                           <span class="s1">&#39;Root Mean Squared Error (RMSE)&#39;</span><span class="p">:[],</span>
                           <span class="s1">&#39;R-squared (training)&#39;</span><span class="p">:[],</span>
                           <span class="s1">&#39;Adjusted R-squared (training)&#39;</span><span class="p">:[],</span>
                           <span class="s1">&#39;R-squared (test)&#39;</span><span class="p">:[],</span>
                           <span class="s1">&#39;Adjusted R-squared (test)&#39;</span><span class="p">:[],</span>
                           <span class="s1">&#39;5-Fold Cross Validation&#39;</span><span class="p">:[]})</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">adjustedR2</span><span class="p">(</span><span class="n">r2</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">k</span><span class="p">):</span>        <span class="c1">## n=num of observations and k=num of parameters</span>
    <span class="k">return</span> <span class="n">r2</span><span class="o">-</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">r2</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <p>Train and test data
<strong>SIMPLE LINEAR REGRESSION</strong> - The predictor variable is &lsquo;Area&rsquo;</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">train_data</span><span class="p">,</span><span class="n">test_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df7</span><span class="p">,</span><span class="n">train_size</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      <p><strong>MULTIPLE LINEAR REGRESSION WITH SELECTED FEATURES:</strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">lr</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>

<span class="n">X_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">y_test</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span>

<span class="n">pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">rmse_lr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">pred</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtr_lr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rte_lr</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">lr</span><span class="p">,</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;Area&#39;</span><span class="p">]],</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>

<span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Average Price for Test Data using Area as the only predictor : </span><span class="si">{:.3f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Intercept: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">intercept_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coefficient: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lr</span><span class="o">.</span><span class="n">coef_</span><span class="p">))</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">evaluation</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">evaluation</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Simple Linear Regression&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">rmse_lr</span><span class="p">,</span><span class="n">rtr_lr</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">rte_lr</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">cv</span><span class="p">]</span>
<span class="n">evaluation</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <p><strong>RIDGE REGRESSION</strong> with hyperparameter <strong>alpha = { 1 , 100 , 1000 }</strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">features</span> <span class="o">=</span> <span class="n">df7</span><span class="o">.</span><span class="n">columns</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Price&#39;</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>

<span class="n">train_data_2</span><span class="p">,</span><span class="n">test_data_2</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df7</span><span class="p">,</span><span class="n">train_size</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">complex_model_1</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span>
<span class="n">complex_model_1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Intercept: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">complex_model_1</span><span class="o">.</span><span class="n">intercept_</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Coefficients: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">complex_model_1</span><span class="o">.</span><span class="n">coef_</span><span class="p">))</span>

<span class="n">pred</span> <span class="o">=</span> <span class="n">complex_model_1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">rmse_cm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">pred</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtr_cm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artr_cm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">train_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rte_cm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">arte_cm</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_1</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">test_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">complex_model_1</span><span class="p">,</span><span class="n">df7</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">evaluation</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">evaluation</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Multiple Regression&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">rmse_cm</span><span class="p">,</span><span class="n">rtr_cm</span><span class="p">,</span><span class="n">artr_cm</span><span class="p">,</span><span class="n">rte_cm</span><span class="p">,</span><span class="n">arte_cm</span><span class="p">,</span><span class="n">cv</span><span class="p">]</span>
<span class="n">evaluation</span> <span class="c1">## evaluation.sort_values(by = &#39;5-Fold Cross Validation&#39;, ascending=False)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p><strong>LASSO REGRESSION</strong> with hyperparameter <strong>alpha = { 1 , 100 , 1000 }</strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">complex_model_R</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">complex_model_R</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>

<span class="n">pred1</span> <span class="o">=</span> <span class="n">complex_model_R</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">rmsecm1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">pred1</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtrcm1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_R</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artrcm1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_R</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">train_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtecm1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_R</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artecm1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_R</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">test_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">complex_model_R</span><span class="p">,</span><span class="n">df7</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>

<span class="n">complex_model_R</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">complex_model_R</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>

<span class="n">pred2</span> <span class="o">=</span> <span class="n">complex_model_R</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">rmsecm2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">pred2</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtrcm2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_R</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artrcm2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_R</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">train_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtecm2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_R</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artecm2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_R</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">test_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">complex_model_R</span><span class="p">,</span><span class="n">df7</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>

<span class="n">complex_model_R</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">complex_model_R</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>

<span class="n">pred3</span> <span class="o">=</span> <span class="n">complex_model_R</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">rmsecm3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">pred3</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtrcm3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_R</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artrcm3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_R</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">train_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtecm3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_R</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artecm3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_R</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">test_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">complex_model_R</span><span class="p">,</span><span class="n">df7</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">evaluation</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">evaluation</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Ridge Regression&#39;</span><span class="p">,</span><span class="s1">&#39;alpha=1&#39;</span><span class="p">,</span><span class="n">rmsecm1</span><span class="p">,</span><span class="n">rtrcm1</span><span class="p">,</span><span class="n">artrcm1</span><span class="p">,</span><span class="n">rtecm1</span><span class="p">,</span><span class="n">artecm1</span><span class="p">,</span><span class="n">cv1</span><span class="p">]</span>
<span class="n">evaluation</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Ridge Regression&#39;</span><span class="p">,</span><span class="s1">&#39;alpha=100&#39;</span><span class="p">,</span><span class="n">rmsecm2</span><span class="p">,</span><span class="n">rtrcm2</span><span class="p">,</span><span class="n">artrcm2</span><span class="p">,</span><span class="n">rtecm2</span><span class="p">,</span><span class="n">artecm2</span><span class="p">,</span><span class="n">cv2</span><span class="p">]</span>
<span class="n">evaluation</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Ridge Regression&#39;</span><span class="p">,</span><span class="s1">&#39;alpha=1000&#39;</span><span class="p">,</span><span class="n">rmsecm3</span><span class="p">,</span><span class="n">rtrcm3</span><span class="p">,</span><span class="n">artrcm3</span><span class="p">,</span><span class="n">rtecm3</span><span class="p">,</span><span class="n">artecm3</span><span class="p">,</span><span class="n">cv3</span><span class="p">]</span>
<span class="n">evaluation</span> <span class="c1">## evaluation.sort_values(by = &#39;5-Fold Cross Validation&#39;, ascending=False)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <p><strong>POLYNOMIAL REGRESSION</strong> with selected features</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">complex_model_L</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">complex_model_L</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>

<span class="n">pred1</span> <span class="o">=</span> <span class="n">complex_model_L</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">rmsecm1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">pred1</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtrcm1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_L</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artrcm1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_L</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">train_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtecm1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_L</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artecm1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_L</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">test_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">complex_model_L</span><span class="p">,</span><span class="n">df7</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>

<span class="n">complex_model_L</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">complex_model_L</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>

<span class="n">pred2</span> <span class="o">=</span> <span class="n">complex_model_L</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">rmsecm2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">pred2</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtrcm2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_L</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artrcm2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_L</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">train_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtecm2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_L</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artecm2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_L</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">test_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">complex_model_L</span><span class="p">,</span><span class="n">df7</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>

<span class="n">complex_model_L</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">complex_model_L</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>

<span class="n">pred3</span> <span class="o">=</span> <span class="n">complex_model_L</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">rmsecm3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">pred3</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtrcm3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_L</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artrcm3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_L</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">train_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtecm3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">complex_model_L</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">artecm3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">adjustedR2</span><span class="p">(</span><span class="n">complex_model_L</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">test_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">test_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="n">test_data_2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv3</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">complex_model_L</span><span class="p">,</span><span class="n">df7</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">evaluation</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">evaluation</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Lasso Regression&#39;</span><span class="p">,</span><span class="s1">&#39;alpha=1&#39;</span><span class="p">,</span><span class="n">rmsecm1</span><span class="p">,</span><span class="n">rtrcm1</span><span class="p">,</span><span class="n">artrcm1</span><span class="p">,</span><span class="n">rtecm1</span><span class="p">,</span><span class="n">artecm1</span><span class="p">,</span><span class="n">cv1</span><span class="p">]</span>
<span class="n">evaluation</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Lasso Regression&#39;</span><span class="p">,</span><span class="s1">&#39;alpha=100&#39;</span><span class="p">,</span><span class="n">rmsecm2</span><span class="p">,</span><span class="n">rtrcm2</span><span class="p">,</span><span class="n">artrcm2</span><span class="p">,</span><span class="n">rtecm2</span><span class="p">,</span><span class="n">artecm2</span><span class="p">,</span><span class="n">cv2</span><span class="p">]</span>
<span class="n">evaluation</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Lasso Regression&#39;</span><span class="p">,</span><span class="s1">&#39;alpha=1000&#39;</span><span class="p">,</span><span class="n">rmsecm3</span><span class="p">,</span><span class="n">rtrcm3</span><span class="p">,</span><span class="n">artrcm3</span><span class="p">,</span><span class="n">rtecm3</span><span class="p">,</span><span class="n">artecm3</span><span class="p">,</span><span class="n">cv3</span><span class="p">]</span>
<span class="n">evaluation</span> <span class="c1">## evaluation.sort_values(by = &#39;5-Fold Cross Validation&#39;, ascending=False)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">evaluation_poly</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Model&#39;</span><span class="p">:</span> <span class="p">[],</span>
                                <span class="s1">&#39;Details&#39;</span><span class="p">:[],</span>
                                <span class="s1">&#39;Root Mean Squared Error (RMSE)&#39;</span><span class="p">:[],</span>
                                <span class="s1">&#39;R-squared (training)&#39;</span><span class="p">:[],</span>
                                <span class="s1">&#39;Adjusted R-squared (training)&#39;</span><span class="p">:[],</span>
                                <span class="s1">&#39;R-squared (test)&#39;</span><span class="p">:[],</span>
                                <span class="s1">&#39;Adjusted R-squared (test)&#39;</span><span class="p">:[],</span>
                                <span class="s1">&#39;5-Fold Cross Validation&#39;</span><span class="p">:[]})</span>


<span class="n">features</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Area&#39;</span><span class="p">,</span> <span class="s1">&#39;No. of Bedrooms&#39;</span><span class="p">,</span> <span class="s1">&#39;Gymnasium&#39;</span><span class="p">,</span> <span class="s1">&#39;CarParking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hospital&#39;</span><span class="p">]</span>   <span class="c1"># features = [&#39;Area&#39;],  # features = [&#39;Area&#39;,&#39;No. of Bedrooms&#39;,&#39;SwimmingPool&#39;,&#39;PowerBackup&#39;,&#39;Gasconnection&#39;,&#39;AC&#39;,&quot;Children&#39;splayarea&quot;]</span>

<span class="n">train_data</span><span class="p">,</span><span class="n">test_data</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df7</span><span class="p">,</span><span class="n">train_size</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>


<span class="n">polyfeat</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_allpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df7</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">X_trainpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">X_testpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainpoly</span><span class="p">,</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>

<span class="n">pred1</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_testpoly</span><span class="p">)</span>
<span class="n">rmsepoly1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">pred1</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtrpoly1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_trainpoly</span><span class="p">,</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtepoly1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_testpoly</span><span class="p">,</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">(),</span><span class="n">X_allpoly</span><span class="p">,</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>

<span class="n">polyfeat</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">X_allpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df7</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">X_trainpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">X_testpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainpoly</span><span class="p">,</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>

<span class="n">pred2</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_testpoly</span><span class="p">)</span>
<span class="n">rmsepoly2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">pred2</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtrpoly2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_trainpoly</span><span class="p">,</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtepoly2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_testpoly</span><span class="p">,</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">linear_model</span><span class="o">.</span><span class="n">LinearRegression</span><span class="p">(),</span><span class="n">X_allpoly</span><span class="p">,</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <h6></h6>
<h1>Our final model - <strong>Ridge Regression alpha=1</strong></h1>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">polyfeat</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_allpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df7</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">X_trainpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">X_testpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainpoly</span><span class="p">,</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>

<span class="n">pred7</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_testpoly</span><span class="p">)</span>
<span class="n">rmsepoly7</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">pred7</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtrpoly7</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_trainpoly</span><span class="p">,</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtepoly7</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_testpoly</span><span class="p">,</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv7</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span><span class="n">X_allpoly</span><span class="p">,</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>

<span class="n">polyfeat</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">X_allpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df7</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">X_trainpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">X_testpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainpoly</span><span class="p">,</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>

<span class="n">pred8</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_testpoly</span><span class="p">)</span>
<span class="n">rmsepoly8</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">pred8</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtrpoly8</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_trainpoly</span><span class="p">,</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtepoly8</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_testpoly</span><span class="p">,</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv8</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">linear_model</span><span class="o">.</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span><span class="n">X_allpoly</span><span class="p">,</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>

<span class="n">polyfeat</span> <span class="o">=</span> <span class="n">PolynomialFeatures</span><span class="p">(</span><span class="n">degree</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">X_allpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df7</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">X_trainpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">X_testpoly</span> <span class="o">=</span> <span class="n">polyfeat</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="n">features</span><span class="p">])</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_trainpoly</span><span class="p">,</span> <span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span>

<span class="n">pred9</span> <span class="o">=</span> <span class="n">poly</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_testpoly</span><span class="p">)</span>
<span class="n">rmsepoly9</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">pred9</span><span class="p">)),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtrpoly9</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_trainpoly</span><span class="p">,</span><span class="n">train_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">rtepoly9</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">poly</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_testpoly</span><span class="p">,</span><span class="n">test_data</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>
<span class="n">cv9</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">linear_model</span><span class="o">.</span><span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">),</span><span class="n">X_allpoly</span><span class="p">,</span><span class="n">df7</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">],</span><span class="n">cv</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span><span class="s1">&#39;.3f&#39;</span><span class="p">))</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">evaluation_poly</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">evaluation_poly</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Polynomial Regression&#39;</span><span class="p">,</span><span class="s1">&#39;degree=2, all features&#39;</span><span class="p">,</span><span class="n">rmsepoly1</span><span class="p">,</span><span class="n">rtrpoly1</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">rtepoly1</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">cv1</span><span class="p">]</span>
<span class="n">evaluation_poly</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Polynomial Regression&#39;</span><span class="p">,</span><span class="s1">&#39;degree=3, all features&#39;</span><span class="p">,</span><span class="n">rmsepoly2</span><span class="p">,</span><span class="n">rtrpoly2</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">rtepoly2</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,(</span><span class="n">cv2</span><span class="p">)]</span>
<span class="n">evaluation_poly</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Polynomial Ridge Regression&#39;</span><span class="p">,</span><span class="s1">&#39;alpha=50000, degree=2, all features&#39;</span><span class="p">,</span><span class="n">rmsepoly7</span><span class="p">,</span><span class="n">rtrpoly7</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">rtepoly7</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">cv7</span><span class="p">]</span>
<span class="n">evaluation_poly</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Polynomial Lasso Regression&#39;</span><span class="p">,</span><span class="s1">&#39;alpha=1, degree=2, all features&#39;</span><span class="p">,</span><span class="n">rmsepoly8</span><span class="p">,</span><span class="n">rtrpoly8</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">rtepoly8</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">cv8</span><span class="p">]</span>
<span class="n">evaluation_poly</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">r</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Polynomial Lasso Regression&#39;</span><span class="p">,</span><span class="s1">&#39;alpha=50000, degree=3, all features&#39;</span><span class="p">,</span><span class="n">rmsepoly9</span><span class="p">,</span><span class="n">rtrpoly9</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">rtepoly9</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="n">cv9</span><span class="p">]</span>
<span class="n">evaluation_poly_temp</span> <span class="o">=</span> <span class="n">evaluation_poly</span><span class="p">[[</span><span class="s1">&#39;Model&#39;</span><span class="p">,</span><span class="s1">&#39;Details&#39;</span><span class="p">,</span><span class="s1">&#39;Root Mean Squared Error (RMSE)&#39;</span><span class="p">,</span><span class="s1">&#39;R-squared (training)&#39;</span><span class="p">,</span><span class="s1">&#39;R-squared (test)&#39;</span><span class="p">,</span><span class="s1">&#39;5-Fold Cross Validation&#39;</span><span class="p">]]</span>
<span class="n">evaluation_poly_temp</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="s1">&#39;5-Fold Cross Validation&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <p><strong>Making dependent dropdown widget</strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="n">features</span> <span class="o">=</span> <span class="n">df7</span><span class="o">.</span><span class="n">columns</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Price&#39;</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
<span class="n">features</span> <span class="o">=</span> <span class="n">features</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>

<span class="n">train_data_2</span><span class="p">,</span><span class="n">test_data_2</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df7</span><span class="p">,</span><span class="n">train_size</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">,</span><span class="n">random_state</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">complex_model_R7</span> <span class="o">=</span> <span class="n">linear_model</span><span class="o">.</span><span class="n">Ridge</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">complex_model_R7</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">],</span><span class="n">train_data_2</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="n">interact</span><span class="p">,</span> <span class="n">interactive</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="n">interact_manual</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>
<span class="kn">from</span> <span class="nn">ipywidgets</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">folium</span>
<span class="kn">from</span> <span class="nn">folium</span> <span class="kn">import</span> <span class="n">Choropleth</span><span class="p">,</span> <span class="n">Circle</span><span class="p">,</span> <span class="n">Marker</span>
<span class="kn">from</span> <span class="nn">folium.plugins</span> <span class="kn">import</span> <span class="n">HeatMap</span><span class="p">,</span> <span class="n">MarkerCluster</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span><span class="p">,</span> <span class="n">display</span>

<span class="n">df_widget</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_widget</span> <span class="o">=</span> <span class="n">df_widget</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span> <span class="s1">&#39;Area&#39;</span><span class="p">,</span> <span class="s1">&#39;No. of Bedrooms&#39;</span><span class="p">,</span> <span class="s1">&#39;Gymnasium&#39;</span><span class="p">,</span> <span class="s1">&#39;CarParking&#39;</span><span class="p">,</span> <span class="s1">&#39;Hospital&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">City_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mumbai&#39;</span><span class="p">,</span> <span class="s1">&#39;Banglore&#39;</span><span class="p">,</span><span class="s1">&#39;Hyderabad&#39;</span><span class="p">,</span><span class="s1">&#39;Kolkata&#39;</span><span class="p">,</span><span class="s1">&#39;Chennai&#39;</span><span class="p">,</span><span class="s1">&#39;Delhi&#39;</span><span class="p">]</span>

<span class="n">df_city</span> <span class="o">=</span> <span class="n">df_widget</span><span class="p">[</span><span class="n">df_widget</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Delhi&#39;</span><span class="p">]</span>
<span class="n">list_Delhi</span> <span class="o">=</span> <span class="n">df_city</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">df_city</span> <span class="o">=</span> <span class="n">df_widget</span><span class="p">[</span><span class="n">df_widget</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Chennai&#39;</span><span class="p">]</span>
<span class="n">list_Chenn</span> <span class="o">=</span> <span class="n">df_city</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">df_city</span> <span class="o">=</span> <span class="n">df_widget</span><span class="p">[</span><span class="n">df_widget</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Kolkata&#39;</span><span class="p">]</span>
<span class="n">list_Kol</span> <span class="o">=</span> <span class="n">df_city</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">df_city</span> <span class="o">=</span> <span class="n">df_widget</span><span class="p">[</span><span class="n">df_widget</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Hyderabad&#39;</span><span class="p">]</span>
<span class="n">list_Hyd</span> <span class="o">=</span> <span class="n">df_city</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">df_city</span> <span class="o">=</span> <span class="n">df_widget</span><span class="p">[</span><span class="n">df_widget</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Banglore&#39;</span><span class="p">]</span>
<span class="n">list_Bang</span> <span class="o">=</span> <span class="n">df_city</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">df_city</span> <span class="o">=</span> <span class="n">df_widget</span><span class="p">[</span><span class="n">df_widget</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Mumbai&#39;</span><span class="p">]</span>
<span class="n">list_Mum</span> <span class="o">=</span> <span class="n">df_city</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">df_CityWidget</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span> <span class="n">list_Mum</span><span class="p">,</span> <span class="n">list_Bang</span><span class="p">,</span> <span class="n">list_Hyd</span><span class="p">,</span> <span class="n">list_Kol</span><span class="p">,</span> <span class="n">list_Chenn</span><span class="p">,</span> <span class="n">list_Delhi</span><span class="p">],</span> <span class="n">index</span> <span class="o">=</span> <span class="n">City_list</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>


<span class="n">c_widget</span> <span class="o">=</span> <span class="n">Dropdown</span><span class="p">(</span><span class="n">options</span> <span class="o">=</span> <span class="n">City_list</span><span class="p">)</span> 
<span class="n">l_widget</span> <span class="o">=</span> <span class="n">Dropdown</span><span class="p">()</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p>Define a function that updates the content of y based on what we select for x</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="n">l_widget</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="n">df_CityWidget</span><span class="p">[</span><span class="n">c_widget</span><span class="o">.</span><span class="n">value</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> 
    
<span class="n">c_widget</span><span class="o">.</span><span class="n">observe</span><span class="p">(</span><span class="n">update</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <p>Some function you want executed
<strong>Predicting price and displaying heat map:</strong></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">random_function</span><span class="p">(</span><span class="n">c</span><span class="p">,</span><span class="n">l</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;c=&#39;</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="s1">&#39; and l=&#39;</span><span class="p">,</span><span class="n">l</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">Predict_Price</span><span class="p">(</span><span class="n">Area</span><span class="p">,</span> <span class="n">Bedrooms</span><span class="p">,</span> <span class="n">City</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">Gym</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Car</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Hospital</span><span class="o">=</span><span class="mi">0</span>  <span class="p">)</span> <span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <p>Location might not be in features, so we&rsquo;ve to check it</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>    <span class="k">if</span> <span class="n">location</span> <span class="ow">in</span> <span class="n">features</span> <span class="p">:</span>
        <span class="n">x7</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">features</span><span class="p">))</span>
        <span class="n">x7</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">Area</span>
        <span class="n">x7</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Bedrooms</span>
        <span class="n">x7</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">Gym</span>       <span class="c1">#0/1</span>
        <span class="n">x7</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">Car</span>       <span class="c1">#0/1</span>
        <span class="n">x7</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">Hospital</span>  <span class="c1">#0/1</span>
        <span class="n">loc_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">train_data_2</span><span class="p">[</span><span class="n">features</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">==</span><span class="n">location</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">x7</span><span class="p">[</span><span class="n">loc_index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                       
        <span class="n">prediction7</span> <span class="o">=</span> <span class="n">complex_model_R7</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x7</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Price is </span><span class="se">\u20B9</span><span class="s2">&quot;</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prediction7</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span><span class="s2">&quot;Lakhs&quot;</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      <p>Heatmap of all places in given City with marker at particlar location</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>        <span class="n">df_city</span> <span class="o">=</span> <span class="n">df3</span><span class="p">[</span><span class="n">df3</span><span class="p">[</span><span class="s1">&#39;City&#39;</span><span class="p">]</span><span class="o">==</span><span class="n">City</span><span class="p">]</span>
        <span class="n">lat_long</span> <span class="o">=</span> <span class="n">location_to_code</span><span class="p">[</span><span class="n">location</span><span class="p">]</span>
        <span class="n">city_map</span> <span class="o">=</span> <span class="n">folium</span><span class="o">.</span><span class="n">Map</span><span class="p">(</span><span class="n">location</span><span class="o">=</span><span class="n">lat_long</span><span class="p">,</span> <span class="n">zoom_start</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">tiles</span><span class="o">=</span><span class="s1">&#39;cartodbpositron&#39;</span><span class="p">)</span>
        <span class="n">mc</span><span class="o">=</span><span class="n">MarkerCluster</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">df_city</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
            <span class="n">mc</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">Marker</span><span class="p">((</span><span class="n">row</span><span class="p">[</span><span class="s1">&#39;Latitude&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Longitude&#39;</span><span class="p">])))</span>
        <span class="n">folium</span><span class="o">.</span><span class="n">Marker</span><span class="p">(</span> <span class="n">location</span><span class="o">=</span><span class="n">lat_long</span><span class="p">,</span> <span class="n">popup</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\u20B9</span><span class="s2">&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{:.2f}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">prediction7</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span><span class="o">+</span><span class="s2">&quot; Lakhs&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">add_to</span><span class="p">(</span><span class="n">city_map</span><span class="p">)</span>
        <span class="n">city_map</span><span class="o">.</span><span class="n">add_child</span><span class="p">(</span><span class="n">mc</span><span class="p">)</span>
        <span class="n">display</span><span class="p">(</span><span class="n">city_map</span><span class="p">)</span>
    
    <span class="k">else</span> <span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Enter location only from the given list!&#39;</span><span class="p">)</span>

<span class="n">interact</span><span class="p">(</span><span class="n">Predict_Price</span><span class="p">,</span> <span class="n">Area</span><span class="o">=</span><span class="p">(</span><span class="mi">400</span><span class="p">,</span><span class="mi">5000</span><span class="p">),</span> <span class="n">Bedrooms</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">IntSlider</span><span class="p">(</span><span class="nb">min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span> 
         <span class="n">City</span><span class="o">=</span><span class="n">c_widget</span><span class="p">,</span><span class="n">location</span><span class="o">=</span><span class="n">l_widget</span><span class="p">);</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
